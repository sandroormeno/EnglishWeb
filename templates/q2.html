<!DOCTYPE html>
<html>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3pro.css">
<head>
    <meta charset="UTF-8">
    <title>2nd Question</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<style>
body {
    margin: 0;
    display: grid;
    min-height: 100vh;
    grid-template-rows: auto 1fr auto;
}
.header{
    background: rgb(255, 255, 255);
    height: 50px;
}
.main{
    background: rgb(255, 255, 255);
}
.footer{
    background: rgb(250, 250, 250);
    height: 150px;
    padding: 1em 0;
    bottom: 0;
}
.material-icons{
    color: rgb(36, 189, 255);
    font-size: 36px;
}

.material-icons[name='slow']{
    font-size: 42px;
}
img {
    margin: 10px 0 10px 0;
    width: 340px;
}

img[name='hola']{
    margin: 20px 0 20px 0;
    width: 150px;
}

button {
    color: rgb(90, 90, 90);
}
table{
    margin-left: auto;
    margin-right: auto;
    width:auto;
}
.swal-text {
    text-align: center;
}

tr.collapse {
    visibility: collapse;
}
input[value=""]{
	display:none;
}
input[name='hide']{
    width:  fit-content;
    margin: 4px 1px;
    padding: 15px 16px; 
    border: none;
    border-radius: 15px;
    color: rgb(154, 152, 152);
    background-color: #ededed;
    font-size: 0.8em;
    font-family: verdana;
    text-align: center;
    cursor: pointer;
    /*pointer-events: none;
    /*border: solid 3px #e1e1e1;*/
}
input[name='hide']:hover {
    background-color: #ededed;
}
table ,th {
    padding: 5px;
    margin: 0 auto; 
}
th {
    border: none;
    height: 50px;
}
.main{
    background: white;
    height: 100;
    padding: 1em 0;
    bottom: 0;
    align-items: center;
}
.check {
    
    font-size: 0.8em;
    font-family: verdana;
}
  
</style>
</head>
<body>
    <header class="header">
        <img src= {{ question[2] }}> 
        
    </header>
    <main class="main">
        <!-- los audios de botones-->
        {% for myaudio in botones %}
        <audio id= {{ myaudio[0] }} src={{ myaudio[3] }} preload="auto"></audio>
        {% endfor %}
        <!-- los audios de pregunta-->
        {% for myaudio in myAudios %}
            <audio id= {{ myaudio[0] }} src={{ myaudio[1] }} preload="auto"></audio>
        {% endfor %}
        <p> {{ question[0] }}</p>
        <table>
            <tr>
            <td><a href="javascript:play_single_sound();"><i class="material-icons">play_circle_filled</i></a></td>
            <td><a href="javascript:play_single_sound_slow();"><i class="material-icons" name='slow'>slideshow</i></a></td>
        </tr>
    </table>
    <hr style="margin-left:20px; margin-right:20px; color:#e7e8e7; background-color:#e7e8e7">
    <table style="height:160px;">
    <tr>   
        <th>
        <div id="mis_botones"></div>
        </th>    
    </tr> 
    </table>
    <script>
        // Pongo 32 botones dumies 
        let salida = "";
        for (let i = 0; i < 32; i++) {
          //text += cars[i] + "<br>";
          salida += "<input type='button' name='hide' onclick='borrar(" + i + ")' value=''>"
        }   
        document.getElementById("mis_botones").innerHTML = salida;
    </script>
    <hr style="margin-left:20px; margin-right:20px; color:#e7e8e7; background-color:#e7e8e7">
    <table>
        <!-- shuffle  jscript: https://www.w3schools.com/js/tryit.asp?filename=tryjs_array_sort -->
        
        <th style="width:320px;"> 
            {% for boton in botones %}
                <button type="button" class='check' onclick='poner("{{ boton[0] }}")'>{{ boton[0] }}</button>  
            {% endfor %}
          <!-- 
          <button type="button" class='check' onclick='poner("what")'>what</button>
          <button type="button" class='check' onclick='poner("is")'>is</button>
          <button type="button" class='check' onclick='poner("your")'>your</button>
          <button type="button" class='check' onclick='poner("name")'>name</button>
          -->
        </th> 
      </table> 
      <p id="demo"></p> 
    </main>
    <footer class="footer" id="myfooter">
        <form action="/questions" method="POST">
            <input type = "hidden" id = "malo" name = "malo">
            <input type = "hidden" id = "numero" name = "numero">
            <button  class="comprobar" type="button" onclick="comprobar()">Comprobar</button><br>
            {# <!--<input type="submit" value="hi" id="greet"> --> #}
        </form>
    </footer>
    <script> 
        /*
        var  pregunta = []
        {% for myaudio in botones %}
        pregunta.push({{myaudio[0]}}); 
        {% endfor %}
        */
        // reproducir el primer audio
        window.onload = function () {
            document.getElementById("audio").play();

        }
        function play_single_sound() {
            document.getElementById('audio').play();
        }
        function play_single_sound_slow() {
            document.getElementById('audioSlow').play();
        }
        // Cambio el color de texto de check y lo hago inactivo
        document.getElementsByClassName("comprobar")[0].style.color= "#ffffff";
        document.getElementsByClassName("comprobar")[0].style.cursor= "not-allowed";
        document.getElementsByClassName("comprobar")[0].style.pointerEvents= "none";

        var btn_num = 0;
        var cont_palabras = 0;
        //var  pregunta = [ "I","want","to","buy","a","house"]
        let tem =  {{ respuestas|safe }}; // esta el testo enviado desde python
        let s_obj = new String(tem) // lo comvierto en string
        const pregunta = s_obj.split(" "); //hago una división en palabras

        // variable para la respuesta corecta:

        let tem_resp_corecta =  {{ res_ok|safe }}; // esta el testo enviado desde python
        let s_resp_corecta = new String(tem_resp_corecta) // lo comvierto en string
        const respuesta = s_resp_corecta.split(" "); //hago una división en palabras

        //var  pregunta = [];
        //document.getElementById("demo").innerHTML = pregunta[1]; // clothing.length
        var palabras = [];
        
        function poner(palabra){
            document.getElementsByName("hide")[btn_num].value = palabra;
            document.getElementsByName("hide")[btn_num].style.border = "Node";
            //alert("Esta es la respuesta : ");
            btn_num = btn_num +1 ;
            cont_palabras = cont_palabras +1;
            palabras.push(palabra); 
            //document.getElementById("demo").innerHTML = palabras;
            // encuenbtra el índice del botón
            index = pregunta.indexOf(palabra);
            //document.getElementById("demo").innerHTML  = index;
            // cambia el color
            document.getElementsByClassName("check")[index].style.color= "#d5d5d5";  
            document.getElementsByClassName("check")[index].style.backgroundColor= "#d5d5d5";
            // cambia atributos
            document.getElementsByClassName("check")[index].style.cursor= "not-allowed";
            document.getElementsByClassName("check")[index].style.pointerEvents= "none";
            // cambiar fuente
            document.getElementsByClassName("check")[index].style.fontFamily = "Verdana";

            var myaudio = document.getElementById(palabra);
            myaudio.play(); 
            // ver cantiidad de palabras selecciondas
            //document.getElementById("demo").innerHTML = cont_palabras;
            btn_confirmar();
        }
        function borrar(numero){
            document.getElementsByName("hide")[numero].value = "";
            cont_palabras = cont_palabras -1;
        // oculto la palabra
            document.getElementsByName("hide")[numero].style.display = "none";
            //quees = document.getElementsByName("hide")[0].value;
            //esto_es = document.getElementsByName("hide")[numero].innerHTML
            // luego hago funcional nuevamente el  boton
            //document.getElementById("demo").innerHTML  = palabras[numero];
            index = pregunta.indexOf(palabras[numero]);
            // cambia el color
            document.getElementsByClassName("check")[index].style.color= "#918e8e";  
            document.getElementsByClassName("check")[index].style.backgroundColor= "#ededed";
            // cambia atributos
            document.getElementsByClassName("check")[index].style.cursor= "default";
            document.getElementsByClassName("check")[index].style.pointerEvents= "all";
            // boorar un elemento:
            /*
            for( var i = 0; i < palabras.length; i++){ 
    
                if ( palabras[i] === palabras[index]) { 
            
                    palabras.splice(i, 1); 
                }
            
            }*/
            // ver cantiidad de palabras selecciondas
            //document.getElementById("demo").innerHTML = cont_palabras;
            btn_confirmar();
        }
        function btn_confirmar(){
            if ( cont_palabras >= 1) { 
                document.getElementsByClassName("comprobar")[0].style.backgroundColor="#24baff";
                //document.getElementsByClassName("comprobar")[0].style.color= "#24baff";
                document.getElementsByClassName("comprobar")[0].style.cursor= "pointer";
                document.getElementsByClassName("comprobar")[0].style.pointerEvents= "all";  
            }else{
                document.getElementsByClassName("comprobar")[0].style.backgroundColor="#ededed";
                //document.getElementsByClassName("comprobar")[0].style.color= "#ffffff";
                document.getElementsByClassName("comprobar")[0].style.cursor= "not-allowed";
                document.getElementsByClassName("comprobar")[0].style.pointerEvents= "none";
            }
        }
        function comprobar(){
            
            var texto = "";
            for( var i = 0; i < 12; i++){
                if (document.getElementsByName("hide")[i].value != ""){
                    texto += document.getElementsByName("hide")[i].value + ","; 
                }               
            }
            //alert(texto);
            let s_texto = new String(texto)
            const turespuesta = s_texto.split(",");
            var ver ="";
            for( var u = 0; u < respuesta.length; u++){
                if(respuesta[u] == turespuesta[u]){
                    ver = "exito"
                }else{
                    ver = "mal"    
                }
            }
            alert(ver);
            //document.getElementById("demo").innerHTML = respuesta.length + turespuesta[0];
        }

    </script>
</body>
</html>